<!DOCTYPE html>
<html>
<head>
  <title>Order Successful</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
  <div class="container mt-5 text-center">
    <h1 class="text-success">Thank you for your purchase!</h1>
    <p>Your order ID is <strong><%= orderId %></strong></p>
    <p class="text-muted">A copy of your invoice is below and in the Invoices page.</p>
  </div>

  <% if (rows && rows.length) { %>
    <div class="container mt-4">
      <div class="card shadow-sm">
        <div class="card-header bg-light d-flex flex-column flex-md-row justify-content-between align-items-md-center">
          <span class="fw-semibold">Invoice details</span>
          <span class="text-muted small">
            Placed on <%= rows[0].createdAt ? new Date(rows[0].createdAt).toLocaleString() : "" %>
          </span>
        </div>

        <div class="card-body">

          <div class="row mb-3">
            <div class="col-md-6">
              <p class="mb-1"><strong>Shipping address:</strong> <%= rows[0].address %></p>
              <p class="mb-0"><strong>Payment method:</strong> <%= rows[0].paymentMethod %></p>
            </div>
            <div class="col-md-6 text-md-end mt-3 mt-md-0">
              <p class="mb-1"><strong>Subtotal:</strong> $<%= Number(rows[0].subtotal).toFixed(2) %></p>
              <p class="mb-1"><strong>Shipping:</strong> $<%= Number(rows[0].shipping).toFixed(2) %></p>
              <h5 class="mt-2 mb-0"><strong>Total:</strong> $<%= Number(rows[0].total).toFixed(2) %></h5>
            </div>
          </div>

          <table class="table table-bordered text-center align-middle mb-0">
            <thead class="table-dark">
              <tr>
                <th>Product</th>
                <th>Qty</th>
                <th>Price</th>
                <th>Line Total</th>
              </tr>
            </thead>
            <tbody>
              <% rows.forEach(item => { %>
                <tr>
                  <td><%= item.productName %></td>
                  <td><%= item.quantity %></td>
                  <td>$<%= Number(item.price).toFixed(2) %></td>
                  <td>$<%= (Number(item.price) * Number(item.quantity)).toFixed(2) %></td>
                </tr>
              <% }) %>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  <% } %>

  <div class="container text-center mt-4 mb-5">
    <a href="/shopping" class="btn btn-primary me-2">Return to Shopping</a>
    <a href="/invoices" class="btn btn-outline-secondary">View all invoices</a>
  </div>
</body>
</html>
